This seems to work correctly. I'm wondering if there's any way to automate opening the programs after upgrade so the database can update. Might look at that later.
